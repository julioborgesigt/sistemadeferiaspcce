<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro Finalizado</title>
   
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <script>// Carrega o banco de dados
        function carregarBancoDados() {
            const url = 'banco_dados.json'; // Defina a URL correta do seu arquivo JSON
        
            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Erro ao carregar o arquivo.');
                    }
                    return response.json();
                })
                .then(jsonData => {
                    database = jsonData;
                    console.log("Banco de dados carregado:", database);
                    // Chama a função exibirDados após carregar o banco de dados
                    exibirDados();
                })
                .catch(error => {
                    console.error('Erro:', error);
                });
        }
        
        // Função para exibir os dados na tabela
        function exibirDados() {
            let matricula = localStorage.getItem('matricula');
            let dados = database[matricula];
        
            if (dados) {
                let html = `<table border="1">
                    <tr><th>Matrícula</th><td>${dados.matricula}</td></tr>
                    <tr><th>Qtd Períodos</th><td>${dados.numeroDePeriodos}</td></tr>
                    <tr><th>Férias Escolar</th><td>${dados.feriasescolarounao}</td></tr>
                    <tr><th>Pontuação Férias Escolar</th><td>${dados.pontuacaoferiasescolar || 'não'}</td></tr>
                    <tr><th>Pontuação Férias Não Escolar</th><td>${dados.pontuacaoferiasNaoescolar || 'não'}</td></tr>
                    <tr><th>Idade</th><td>${dados.idade}</td></tr>`;
        
                // Verificar se os períodos de férias estão definidos
                if (dados.periodo11) {
                    html += `<tr><th>Intenção de Férias P1 (Início)</th><td>${dados.periodo11}</td></tr>
                             <tr><th>Intenção de Férias P1 (Fim)</th><td>${dados.periodo12}</td></tr>`;
                }
                if (dados.periodo21) {
                    html += `<tr><th>Intenção de Férias P2 (Início)</th><td>${dados.periodo21}</td></tr>
                             <tr><th>Intenção de Férias P2 (Fim)</th><td>${dados.periodo22}</td></tr>`;
                }
                if (dados.periodo31) {
                    html += `<tr><th>Intenção de Férias P3 (Início)</th><td>${dados.periodo31}</td></tr>
                             <tr><th>Intenção de Férias P3 (Fim)</th><td>${dados.periodo32}</td></tr>`;
                }
        
                html += `</table>`;
                document.getElementById("dados2").innerHTML = html;
            } else {
                alert("Dados inexistentes.");
            }
        }
        
        // Função para gerar PDF
        function gerarPDF() {
            const { jsPDF } = window.jspdf;
        
            html2canvas(document.querySelector("#dados2")).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF();
                const imgProps = pdf.getImageProperties(imgData);
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
        
                pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
                pdf.save("dados_cadastro.pdf");
            });
        }
        
        // Chama a função carregarBancoDados ao carregar a página
        window.onload = carregarBancoDados;</script>


</head>
<body>
    <h1>Dados do Cadastro</h1>
    <div id="dados2"></div>
    <button onclick="gerarPDF()">Gerar PDF</button>
</body>
</html>
